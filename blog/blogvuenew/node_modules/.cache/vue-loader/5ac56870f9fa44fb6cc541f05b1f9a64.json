{"remainingRequest":"D:\\mycode\\blogvuenew\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\mycode\\blogvuenew\\src\\components\\Manage\\CreateArt.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\mycode\\blogvuenew\\src\\components\\Manage\\CreateArt.vue","mtime":1617639547296},{"path":"D:\\mycode\\blogvuenew\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\mycode\\blogvuenew\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\mycode\\blogvuenew\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\mycode\\blogvuenew\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBhZGRBcnQsIGdldEFydCwgZWRpdEFydCB9IGZyb20gIi4uLy4uL2FwaS9pbmRleCI7DQppbXBvcnQgeyBtYXBHZXR0ZXJzIH0gZnJvbSAidnVleCI7DQppbXBvcnQgeyBoaWdobGlnaHRDb2RlIH0gZnJvbSAiLi4vLi4vbWFpbiI7DQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJDcmVhdGVBcnQiLA0KICBjcmVhdGVkKCkgew0KICAgIHRoaXMuaWQgPSB0aGlzLiRyb3V0ZS5xdWVyeS5pZDsNCiAgICBjb25zb2xlLmxvZyh0aGlzLmlkKTsNCiAgICBpZiAodGhpcy5pZCkgew0KICAgICAgdGhpcy5pc1Nob3cgPSBmYWxzZTsNCiAgICAgIGdldEFydCh0aGlzLmlkKQ0KICAgICAgICAudGhlbigocmVzKSA9PiB7DQogICAgICAgICAgaWYgKHJlcykgew0KICAgICAgICAgICAgdGhpcy5ydWxlRm9ybSA9IHJlcy5kYXRhWzBdOw0KICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKTsNCiAgICAgICAgICB9DQogICAgICAgIH0pDQogICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsNCiAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7DQogICAgICAgIH0pOw0KICAgIH0NCiAgfSwNCiAgY29tcHV0ZWQ6IHsNCiAgICAvLyDkvb/nlKjlr7nosaHlsZXlvIDov5DnrpfnrKblsIYgZ2V0dGVyIOa3t+WFpSBjb21wdXRlZCDlr7nosaHkuK0NCiAgICAuLi5tYXBHZXR0ZXJzKFsNCiAgICAgICJnZXRDbGFzc2lmaWVzIiwNCiAgICAgIC8vIC4uLg0KICAgIF0pLA0KICB9LA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBpZDogIiIsDQogICAgICBjb250ZW50OiAiIiwNCiAgICAgIHJ1bGVGb3JtOiB7DQogICAgICAgIGltZzogIiIsDQogICAgICB9LA0KICAgICAgcnVsZXM6IHsNCiAgICAgICAgdGl0bGU6IFsNCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAi6K+36L6T5YWl5qCH6aKYIiwgdHJpZ2dlcjogImJsdXIiIH0sDQogICAgICAgICAgew0KICAgICAgICAgICAgbWluOiAzLA0KICAgICAgICAgICAgbWF4OiAyNTUsDQogICAgICAgICAgICBtZXNzYWdlOiAi6ZW/5bqm5ZyoIDMg5YiwIDI1NSDkuKrlrZfnrKYiLA0KICAgICAgICAgICAgdHJpZ2dlcjogImJsdXIiLA0KICAgICAgICAgIH0sDQogICAgICAgIF0sDQogICAgICAgIGF1dGhvcjogW3sgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICLor7fovpPlhaXlp5PlkI0iLCB0cmlnZ2VyOiAiYmx1ciIgfV0sDQogICAgICAgIGRlc2NyaXB0aW9uOiBbDQogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogIuivt+i+k+WFpeaRmOimgSIsIHRyaWdnZXI6ICJibHVyIiB9LA0KICAgICAgICBdLA0KICAgICAgICByZWdpb246IFsNCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAi6K+36YCJ5oup5rS75Yqo5Yy65Z+fIiwgdHJpZ2dlcjogImNoYW5nZSIgfSwNCiAgICAgICAgXSwNCiAgICAgICAgY2xhc3NpZnk6IFsNCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAi6K+36L6T5YWl5YiG57G7IiwgdHJpZ2dlcjogImNoYW5nZSIgfSwNCiAgICAgICAgXSwNCiAgICAgICAgY29udGVudDogW3sgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICLor7fovpPlhaXlhoXlrrkiLCB0cmlnZ2VyOiAiYmx1ciIgfV0sDQogICAgICB9LA0KICAgICAgdXJsOiAiIiwNCiAgICAgIGlzU2hvdzogdHJ1ZSwNCiAgICB9Ow0KICB9LA0KICBtZXRob2RzOiB7DQogICAgb25TdWJtaXQoZm9ybU5hbWUpIHsNCiAgICAgIHRoaXMuJHJlZnNbZm9ybU5hbWVdLnZhbGlkYXRlKCh2YWxpZCkgPT4gew0KICAgICAgICBpZiAodmFsaWQpIHsNCiAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLnJ1bGVGb3JtLmltZyk7DQogICAgICAgICAgaWYgKHRoaXMucnVsZUZvcm0uaW1nID09ICIiKSB7DQogICAgICAgICAgICBsZXQgcGljID0gMSArIHBhcnNlSW50KE1hdGgucmFuZG9tKCkgKiA2KTsNCiAgICAgICAgICAgIHRoaXMucnVsZUZvcm0uaW1nID0gYGh0dHA6Ly9yaWNvbG8uY24vYXBpL2ltYWdlLyR7cGljfS5qcGdgOw0KICAgICAgICAgIH0NCiAgICAgICAgICBpZiAodGhpcy4kcm91dGUucXVlcnkuaWQpIHsNCiAgICAgICAgICAgIGVkaXRBcnQodGhpcy5ydWxlRm9ybSkNCiAgICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4gew0KICAgICAgICAgICAgICAgIGlmIChyZXMuY29kZSA9PSAiMjAwIikgew0KICAgICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7DQogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICLkv67mlLnmlofnq6DmiJDlip8iLA0KICAgICAgICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsDQogICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiA1MDAsDQogICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7DQogICAgICAgICAgICAgICAgICAgIHNob3dDbG9zZTogdHJ1ZSwNCiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogIuaXoOazleS/ruaUueaWh+eroCIsDQogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsDQogICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiA1MDAsDQogICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goeyBwYXRoOiAiL2VkaXRhcnQiIH0pOw0KICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7DQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOw0KICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy5ydWxlRm9ybSk7DQogICAgICAgICAgICBhZGRBcnQodGhpcy5ydWxlRm9ybSkNCiAgICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4gew0KICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7DQogICAgICAgICAgICAgICAgaWYgKHJlcy5jb2RlID09ICIyMDAiKSB7DQogICAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogIua3u+WKoOaWh+eroOaIkOWKnyIsDQogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwNCiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IDEwMDAsDQogICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgcGF0aDogIi9lZGl0YXJ0IiB9KTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7DQogICAgICAgICAgICAgICAgICAgIHNob3dDbG9zZTogdHJ1ZSwNCiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogIuaXoOazlea3u+WKoOaWh+eroCIsDQogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsDQogICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAxMDAwLA0KICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7DQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOw0KICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH0pOw0KICAgICAgdGhpcy4kcmVmcy51cGxvYWQuc3VibWl0KCk7DQogICAgfSwNCiAgICByZXNldEZvcm0oZm9ybU5hbWUpIHsNCiAgICAgIGlmICh0aGlzLmlkKSB7DQogICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgcGF0aDogIi9lZGl0YXJ0IiB9KTsNCiAgICAgIH0NCiAgICAgIHRoaXMuJHJlZnNbZm9ybU5hbWVdLnJlc2V0RmllbGRzKCk7DQogICAgfSwNCiAgICBoYW5kbGVTdWNjZXNzKHJlcykgew0KICAgICAgdGhpcy5ydWxlRm9ybS5pbWcgPSByZXM7DQogICAgICBpZiAodGhpcy5ydWxlRm9ybS5pbWcudXJsKSB7DQogICAgICAgIHRoaXMudXJsID0gYGh0dHA6Ly9yaWNvbG8uY24vYXBpLyR7dGhpcy5ydWxlRm9ybS5pbWcudXJsfWA7DQogICAgICAgIHRoaXMuaXNTaG93ID0gZmFsc2U7DQogICAgICAgIHRoaXMucnVsZUZvcm0uaW1nID0gdGhpcy51cmw7DQogICAgICB9DQogICAgfSwNCiAgICBoYW5kbGVSZW1vdmUoZmlsZSwgZmlsZUxpc3QpIHsNCiAgICAgIGNvbnNvbGUubG9nKGZpbGUsIGZpbGVMaXN0KTsNCiAgICB9LA0KICAgIGhhbmRsZVByZXZpZXcoZmlsZSkgew0KICAgICAgY29uc29sZS5sb2coZmlsZSk7DQogICAgICBjb25zb2xlLmxvZyh0aGlzLmZpbGVMaXN0KTsNCiAgICB9LA0KICB9LA0KICBtb3VudGVkKCkgew0KICAgIGhpZ2hsaWdodENvZGUoKTsNCiAgfSwNCg0KICB1cGRhdGVkKCkgew0KICAgIGhpZ2hsaWdodENvZGUoKTsNCiAgfSwNCn07DQo="},{"version":3,"sources":["CreateArt.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"CreateArt.vue","sourceRoot":"src/components/Manage","sourcesContent":["<template>\r\n  <div class=\"addart\">\r\n    <el-form\r\n      ref=\"ruleForm\"\r\n      :model=\"ruleForm\"\r\n      :rules=\"rules\"\r\n      label-width=\"100px\"\r\n      class=\"demo-ruleForm\"\r\n    >\r\n      <el-form-item label=\"标题\" prop=\"title\">\r\n        <el-input v-model=\"ruleForm.title\" placeholder=\"请填写标题\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"作者\" prop=\"author\">\r\n        <el-input v-model=\"ruleForm.author\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"摘要\" prop=\"description\">\r\n        <el-input type=\"textarea\" v-model=\"ruleForm.description\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"分类\" prop=\"classify\">\r\n        <el-select v-model=\"ruleForm.classify\" placeholder=\"请填写分类\">\r\n          <el-option\r\n            v-for=\"(v, i) in getClassifies\"\r\n            :key=\"i\"\r\n            :label=\"v\"\r\n            :value=\"v\"\r\n          ></el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"封面\" prop=\"img\">\r\n        <el-upload\r\n          class=\"upload-demo\"\r\n          ref=\"upload\"\r\n          action=\"http://ricolo.cn/api/api/blog/editart/img\"\r\n          :on-preview=\"handlePreview\"\r\n          :on-remove=\"handleRemove\"\r\n          :on-success=\"handleSuccess\"\r\n          :auto-upload=\"true\"\r\n        >\r\n          <el-button slot=\"trigger\" size=\"small\" type=\"primary\"\r\n            >选取文件</el-button\r\n          >\r\n          <div slot=\"tip\" class=\"el-upload__tip\">\r\n            只能上传jpg/png文件，且不超过500kb\r\n          </div>\r\n        </el-upload>\r\n        <img :src=\"url\" alt=\"\" id=\"imgs\" />\r\n      </el-form-item>\r\n      <el-form-item label=\"内容\" prop=\"content\">\r\n        <mavon-editor v-model=\"ruleForm.content\" />\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" @click=\"onSubmit('ruleForm')\"\r\n          >立即创建</el-button\r\n        >\r\n        <el-button @click=\"resetForm('ruleForm')\">取消</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { addArt, getArt, editArt } from \"../../api/index\";\r\nimport { mapGetters } from \"vuex\";\r\nimport { highlightCode } from \"../../main\";\r\nexport default {\r\n  name: \"CreateArt\",\r\n  created() {\r\n    this.id = this.$route.query.id;\r\n    console.log(this.id);\r\n    if (this.id) {\r\n      this.isShow = false;\r\n      getArt(this.id)\r\n        .then((res) => {\r\n          if (res) {\r\n            this.ruleForm = res.data[0];\r\n            console.log(res);\r\n          }\r\n        })\r\n        .catch(function (error) {\r\n          console.log(error);\r\n        });\r\n    }\r\n  },\r\n  computed: {\r\n    // 使用对象展开运算符将 getter 混入 computed 对象中\r\n    ...mapGetters([\r\n      \"getClassifies\",\r\n      // ...\r\n    ]),\r\n  },\r\n  data() {\r\n    return {\r\n      id: \"\",\r\n      content: \"\",\r\n      ruleForm: {\r\n        img: \"\",\r\n      },\r\n      rules: {\r\n        title: [\r\n          { required: true, message: \"请输入标题\", trigger: \"blur\" },\r\n          {\r\n            min: 3,\r\n            max: 255,\r\n            message: \"长度在 3 到 255 个字符\",\r\n            trigger: \"blur\",\r\n          },\r\n        ],\r\n        author: [{ required: true, message: \"请输入姓名\", trigger: \"blur\" }],\r\n        description: [\r\n          { required: true, message: \"请输入摘要\", trigger: \"blur\" },\r\n        ],\r\n        region: [\r\n          { required: true, message: \"请选择活动区域\", trigger: \"change\" },\r\n        ],\r\n        classify: [\r\n          { required: true, message: \"请输入分类\", trigger: \"change\" },\r\n        ],\r\n        content: [{ required: true, message: \"请输入内容\", trigger: \"blur\" }],\r\n      },\r\n      url: \"\",\r\n      isShow: true,\r\n    };\r\n  },\r\n  methods: {\r\n    onSubmit(formName) {\r\n      this.$refs[formName].validate((valid) => {\r\n        if (valid) {\r\n          console.log(this.ruleForm.img);\r\n          if (this.ruleForm.img == \"\") {\r\n            let pic = 1 + parseInt(Math.random() * 6);\r\n            this.ruleForm.img = `http://ricolo.cn/api/image/${pic}.jpg`;\r\n          }\r\n          if (this.$route.query.id) {\r\n            editArt(this.ruleForm)\r\n              .then((res) => {\r\n                if (res.code == \"200\") {\r\n                  this.$message({\r\n                    message: \"修改文章成功\",\r\n                    type: \"success\",\r\n                    duration: 500,\r\n                  });\r\n                } else {\r\n                  this.$message({\r\n                    showClose: true,\r\n                    message: \"无法修改文章\",\r\n                    type: \"error\",\r\n                    duration: 500,\r\n                  });\r\n                }\r\n                this.$router.push({ path: \"/editart\" });\r\n              })\r\n              .catch(function (error) {\r\n                console.log(error);\r\n              });\r\n          } else {\r\n            console.log(this.ruleForm);\r\n            addArt(this.ruleForm)\r\n              .then((res) => {\r\n                console.log(res);\r\n                if (res.code == \"200\") {\r\n                  this.$message({\r\n                    message: \"添加文章成功\",\r\n                    type: \"success\",\r\n                    duration: 1000,\r\n                  });\r\n                  this.$router.push({ path: \"/editart\" });\r\n                } else {\r\n                  this.$message({\r\n                    showClose: true,\r\n                    message: \"无法添加文章\",\r\n                    type: \"error\",\r\n                    duration: 1000,\r\n                  });\r\n                }\r\n              })\r\n              .catch(function (error) {\r\n                console.log(error);\r\n              });\r\n          }\r\n        }\r\n      });\r\n      this.$refs.upload.submit();\r\n    },\r\n    resetForm(formName) {\r\n      if (this.id) {\r\n        this.$router.push({ path: \"/editart\" });\r\n      }\r\n      this.$refs[formName].resetFields();\r\n    },\r\n    handleSuccess(res) {\r\n      this.ruleForm.img = res;\r\n      if (this.ruleForm.img.url) {\r\n        this.url = `http://ricolo.cn/api/${this.ruleForm.img.url}`;\r\n        this.isShow = false;\r\n        this.ruleForm.img = this.url;\r\n      }\r\n    },\r\n    handleRemove(file, fileList) {\r\n      console.log(file, fileList);\r\n    },\r\n    handlePreview(file) {\r\n      console.log(file);\r\n      console.log(this.fileList);\r\n    },\r\n  },\r\n  mounted() {\r\n    highlightCode();\r\n  },\r\n\r\n  updated() {\r\n    highlightCode();\r\n  },\r\n};\r\n</script>\r\n<style scoped lang=\"scss\">\r\n@import \"../../assets/css/base.scss\";\r\n@import \"../../assets/css/mixin.scss\";\r\n.addart {\r\n  padding-right: 20px;\r\n  padding-top: 20px;\r\n  width: 80%;\r\n  margin: 0 auto;\r\n  margin-top: 20px;\r\n  @include font_color();\r\n  @include bg_color();\r\n}\r\n#imgs {\r\n  width: 200px;\r\n  height: 150px;\r\n}\r\n</style>"]}]}