{"remainingRequest":"D:\\mycode\\blogvuenew\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\mycode\\blogvuenew\\src\\components\\Manage\\CreateArt.vue?vue&type=style&index=0&id=12db0ca6&scoped=true&lang=scss&","dependencies":[{"path":"D:\\mycode\\blogvuenew\\src\\components\\Manage\\CreateArt.vue","mtime":1612534054508},{"path":"D:\\mycode\\blogvuenew\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\mycode\\blogvuenew\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\mycode\\blogvuenew\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\mycode\\blogvuenew\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\mycode\\blogvuenew\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\mycode\\blogvuenew\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCkBpbXBvcnQgIi4uLy4uL2Fzc2V0cy9jc3MvYmFzZS5zY3NzIjsNCkBpbXBvcnQgIi4uLy4uL2Fzc2V0cy9jc3MvbWl4aW4uc2NzcyI7DQouYWRkYXJ0IHsNCiAgcGFkZGluZy1yaWdodDogMjBweDsNCiAgcGFkZGluZy10b3A6IDIwcHg7DQogIHdpZHRoOiA4MCU7DQogIG1hcmdpbjogMCBhdXRvOw0KICBtYXJnaW4tdG9wOiAyMHB4Ow0KICBAaW5jbHVkZSBmb250X2NvbG9yKCk7DQogIEBpbmNsdWRlIGJnX2NvbG9yKCk7DQp9DQojaW1nc3sNCiAgd2lkdGg6IDIwMHB4Ow0KICBoZWlnaHQ6IDE1MHB4Ow0KfQ0K"},{"version":3,"sources":["CreateArt.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CreateArt.vue","sourceRoot":"src/components/Manage","sourcesContent":["<template>\r\n  <div class=\"addart\">\r\n    <el-form ref=\"ruleForm\" :model=\"ruleForm\" :rules=\"rules\"  label-width=\"100px\" class=\"demo-ruleForm\">\r\n      <el-form-item label=\"标题\" prop=\"title\">\r\n        <el-input v-model=\"ruleForm.title\" placeholder=\"请填写标题\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"作者\" prop=\"author\">\r\n        <el-input v-model=\"ruleForm.author\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"摘要\" prop=\"description\">\r\n        <el-input type=\"textarea\" v-model=\"ruleForm.description\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"分类\" prop=\"classify\">\r\n        <el-select v-model=\"ruleForm.classify\" placeholder=\"请填写分类\">\r\n          <el-option v-for=\"(v,i) in getClassifies\" :key=\"i\" :label=\"v\" :value=\"v\"></el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"封面\" prop=\"img\">\r\n       <el-upload\r\n        class=\"upload-demo\"\r\n        ref=\"upload\"\r\n        action=\"/api/api/blog/editart/img\"\r\n        :on-preview=\"handlePreview\"\r\n        :on-remove=\"handleRemove\"\r\n        :on-success=\"handleSuccess\"\r\n        :auto-upload=\"true\"\r\n        >\r\n        <el-button slot=\"trigger\" size=\"small\" type=\"primary\">选取文件</el-button>\r\n        <div slot=\"tip\" class=\"el-upload__tip\">只能上传jpg/png文件，且不超过500kb</div>\r\n      </el-upload>\r\n        <img :src=\"url\" alt=\"\" id=\"imgs\">\r\n      </el-form-item>\r\n      <el-form-item label=\"内容\" prop=\"content\">\r\n        <mavon-editor v-model=\"ruleForm.content\" />\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" @click=\"onSubmit('ruleForm')\"\r\n          >立即创建</el-button\r\n        >\r\n        <el-button @click=\"resetForm('ruleForm')\">取消</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { addArt, getArt, editArt } from \"../../api/index\";\r\nimport { mapGetters } from 'vuex'\r\nexport default {\r\n  name: \"CreateArt\",\r\n  created() {\r\n    this.id = this.$route.query.id;\r\n    console.log(this.id);\r\n    if (this.id) {\r\n      this.isShow = false;\r\n      getArt(this.id)\r\n        .then((res) => {\r\n          if (res) {\r\n            this.ruleForm = res.data[0];\r\n            console.log(res);\r\n          }\r\n        })\r\n        .catch(function (error) {\r\n          console.log(error);\r\n        });\r\n    }\r\n  },\r\n  computed: {\r\n  // 使用对象展开运算符将 getter 混入 computed 对象中\r\n    ...mapGetters([\r\n\t  'getClassifies',\r\n      // ... \r\n  ])},\r\n  data() {\r\n    return {\r\n      id: \"\",\r\n      content: \"\",\r\n      ruleForm: {\r\n        img:\"\"\r\n      },\r\n      rules: {\r\n        title: [\r\n          { required: true, message: \"请输入标题\", trigger: \"blur\" },\r\n          {\r\n            min: 3,\r\n            max: 255,\r\n            message: \"长度在 3 到 255 个字符\",\r\n            trigger: \"blur\",\r\n          },\r\n        ],\r\n        author: [{ required: true, message: \"请输入姓名\", trigger: \"blur\" }],\r\n        description: [\r\n          { required: true, message: \"请输入摘要\", trigger: \"blur\" },\r\n        ],\r\n        region: [\r\n          { required: true, message: \"请选择活动区域\", trigger: \"change\" },\r\n        ],\r\n        classify: [\r\n          { required: true, message: \"请输入分类\", trigger: \"change\" },\r\n        ],\r\n        content: [{ required: true, message: \"请输入内容\", trigger: \"blur\" }],\r\n      },\r\n      url:'',\r\n      isShow:true\r\n    };\r\n  },\r\n  methods: {\r\n    onSubmit(formName) {\r\n      this.$refs[formName].validate((valid) => {\r\n        if (valid) {\r\n          console.log(this.ruleForm.img)\r\n          if(this.ruleForm.img == \"\"){\r\n            let pic = 1+parseInt(Math.random()*6);\r\n            this.ruleForm.img = `/api/img/${pic}.jpg`\r\n          }\r\n          if (this.$route.query.id) {\r\n            editArt(this.ruleForm)\r\n              .then((res) => {\r\n                if (res.code == \"200\") {\r\n                  this.$message({\r\n                    message: \"修改文章成功\",\r\n                    type: \"success\",\r\n                    duration: 500,\r\n                  });\r\n                } else {\r\n                  this.$message({\r\n                    showClose: true,\r\n                    message: \"无法修改文章\",\r\n                    type: \"error\",\r\n                    duration: 500,\r\n                  });\r\n                }\r\n                this.$router.push({ path: \"/editart\" });\r\n              })\r\n              .catch(function (error) {\r\n                console.log(error);\r\n              });\r\n          } else {\r\n            console.log(this.ruleForm);\r\n            addArt(this.ruleForm)\r\n              .then((res) => {\r\n                console.log(res);\r\n                if (res.code == \"200\") {\r\n                  this.$message({\r\n                    message: \"添加文章成功\",\r\n                    type: \"success\",\r\n                    duration: 1000,\r\n                  });\r\n                  this.$router.push({ path: \"/editart\" });\r\n                } else {\r\n                  this.$message({\r\n                    showClose: true,\r\n                    message: \"无法添加文章\",\r\n                    type: \"error\",\r\n                    duration: 1000,\r\n                  });\r\n                }\r\n              })\r\n              .catch(function (error) {\r\n                console.log(error);\r\n              });\r\n          }\r\n        }\r\n      });\r\n      this.$refs.upload.submit();\r\n    },\r\n    resetForm(formName) {\r\n        if(this.id){\r\n          this.$router.push({ path: \"/editart\" });\r\n        }\r\n        this.$refs[formName].resetFields();\r\n    },\r\n    handleSuccess(res) {\r\n      this.ruleForm.img = res;\r\n      if(this.ruleForm.img.url){\r\n        this.url = `http://121.4.126.143:7000/${this.ruleForm.img.url}`;  \r\n        this.isShow = false;\r\n        this.ruleForm.img = this.url;\r\n      }\r\n    },\r\n    handleRemove(file, fileList) {\r\n      console.log(file, fileList);\r\n    },\r\n    handlePreview(file) {\r\n      console.log(file);\r\n      console.log(this.fileList);\r\n    }\r\n\r\n  },\r\n};\r\n</script>\r\n<style scoped lang=\"scss\">\r\n@import \"../../assets/css/base.scss\";\r\n@import \"../../assets/css/mixin.scss\";\r\n.addart {\r\n  padding-right: 20px;\r\n  padding-top: 20px;\r\n  width: 80%;\r\n  margin: 0 auto;\r\n  margin-top: 20px;\r\n  @include font_color();\r\n  @include bg_color();\r\n}\r\n#imgs{\r\n  width: 200px;\r\n  height: 150px;\r\n}\r\n</style>"]}]}