{"remainingRequest":"D:\\mycode\\blogvuenew\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\mycode\\blogvuenew\\src\\components\\Manage\\CreateArt.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\mycode\\blogvuenew\\src\\components\\Manage\\CreateArt.vue","mtime":1612601253823},{"path":"D:\\mycode\\blogvuenew\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\mycode\\blogvuenew\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\mycode\\blogvuenew\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBhZGRBcnQsIGdldEFydCwgZWRpdEFydCB9IGZyb20gIi4uLy4uL2FwaS9pbmRleCI7DQppbXBvcnQgeyBtYXBHZXR0ZXJzIH0gZnJvbSAndnVleCcNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogIkNyZWF0ZUFydCIsDQogIGNyZWF0ZWQoKSB7DQogICAgdGhpcy5pZCA9IHRoaXMuJHJvdXRlLnF1ZXJ5LmlkOw0KICAgIGNvbnNvbGUubG9nKHRoaXMuaWQpOw0KICAgIGlmICh0aGlzLmlkKSB7DQogICAgICB0aGlzLmlzU2hvdyA9IGZhbHNlOw0KICAgICAgZ2V0QXJ0KHRoaXMuaWQpDQogICAgICAgIC50aGVuKChyZXMpID0+IHsNCiAgICAgICAgICBpZiAocmVzKSB7DQogICAgICAgICAgICB0aGlzLnJ1bGVGb3JtID0gcmVzLmRhdGFbMF07DQogICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpOw0KICAgICAgICAgIH0NCiAgICAgICAgfSkNCiAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgew0KICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsNCiAgICAgICAgfSk7DQogICAgfQ0KICB9LA0KICBjb21wdXRlZDogew0KICAvLyDkvb/nlKjlr7nosaHlsZXlvIDov5DnrpfnrKblsIYgZ2V0dGVyIOa3t+WFpSBjb21wdXRlZCDlr7nosaHkuK0NCiAgICAuLi5tYXBHZXR0ZXJzKFsNCgkgICdnZXRDbGFzc2lmaWVzJywNCiAgICAgIC8vIC4uLiANCiAgXSl9LA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBpZDogIiIsDQogICAgICBjb250ZW50OiAiIiwNCiAgICAgIHJ1bGVGb3JtOiB7DQogICAgICAgIGltZzoiIg0KICAgICAgfSwNCiAgICAgIHJ1bGVzOiB7DQogICAgICAgIHRpdGxlOiBbDQogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogIuivt+i+k+WFpeagh+mimCIsIHRyaWdnZXI6ICJibHVyIiB9LA0KICAgICAgICAgIHsNCiAgICAgICAgICAgIG1pbjogMywNCiAgICAgICAgICAgIG1heDogMjU1LA0KICAgICAgICAgICAgbWVzc2FnZTogIumVv+W6puWcqCAzIOWIsCAyNTUg5Liq5a2X56ymIiwNCiAgICAgICAgICAgIHRyaWdnZXI6ICJibHVyIiwNCiAgICAgICAgICB9LA0KICAgICAgICBdLA0KICAgICAgICBhdXRob3I6IFt7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAi6K+36L6T5YWl5aeT5ZCNIiwgdHJpZ2dlcjogImJsdXIiIH1dLA0KICAgICAgICBkZXNjcmlwdGlvbjogWw0KICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICLor7fovpPlhaXmkZjopoEiLCB0cmlnZ2VyOiAiYmx1ciIgfSwNCiAgICAgICAgXSwNCiAgICAgICAgcmVnaW9uOiBbDQogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogIuivt+mAieaLqea0u+WKqOWMuuWfnyIsIHRyaWdnZXI6ICJjaGFuZ2UiIH0sDQogICAgICAgIF0sDQogICAgICAgIGNsYXNzaWZ5OiBbDQogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogIuivt+i+k+WFpeWIhuexuyIsIHRyaWdnZXI6ICJjaGFuZ2UiIH0sDQogICAgICAgIF0sDQogICAgICAgIGNvbnRlbnQ6IFt7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAi6K+36L6T5YWl5YaF5a65IiwgdHJpZ2dlcjogImJsdXIiIH1dLA0KICAgICAgfSwNCiAgICAgIHVybDonJywNCiAgICAgIGlzU2hvdzp0cnVlDQogICAgfTsNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIG9uU3VibWl0KGZvcm1OYW1lKSB7DQogICAgICB0aGlzLiRyZWZzW2Zvcm1OYW1lXS52YWxpZGF0ZSgodmFsaWQpID0+IHsNCiAgICAgICAgaWYgKHZhbGlkKSB7DQogICAgICAgICAgY29uc29sZS5sb2codGhpcy5ydWxlRm9ybS5pbWcpDQogICAgICAgICAgaWYodGhpcy5ydWxlRm9ybS5pbWcgPT0gIiIpew0KICAgICAgICAgICAgbGV0IHBpYyA9IDErcGFyc2VJbnQoTWF0aC5yYW5kb20oKSo2KTsNCiAgICAgICAgICAgIHRoaXMucnVsZUZvcm0uaW1nID0gYGh0dHA6Ly9yaWNvbG8uY24vYXBpL2ltYWdlLyR7cGljfS5qcGdgDQogICAgICAgICAgfQ0KICAgICAgICAgIGlmICh0aGlzLiRyb3V0ZS5xdWVyeS5pZCkgew0KICAgICAgICAgICAgZWRpdEFydCh0aGlzLnJ1bGVGb3JtKQ0KICAgICAgICAgICAgICAudGhlbigocmVzKSA9PiB7DQogICAgICAgICAgICAgICAgaWYgKHJlcy5jb2RlID09ICIyMDAiKSB7DQogICAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogIuS/ruaUueaWh+eroOaIkOWKnyIsDQogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwNCiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IDUwMCwNCiAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICAgICAgICAgICAgc2hvd0Nsb3NlOiB0cnVlLA0KICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAi5peg5rOV5L+u5pS55paH56ugIiwNCiAgICAgICAgICAgICAgICAgICAgdHlwZTogImVycm9yIiwNCiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IDUwMCwNCiAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IHBhdGg6ICIvZWRpdGFydCIgfSk7DQogICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7DQogICAgICAgICAgICAgIH0pOw0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLnJ1bGVGb3JtKTsNCiAgICAgICAgICAgIGFkZEFydCh0aGlzLnJ1bGVGb3JtKQ0KICAgICAgICAgICAgICAudGhlbigocmVzKSA9PiB7DQogICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKTsNCiAgICAgICAgICAgICAgICBpZiAocmVzLmNvZGUgPT0gIjIwMCIpIHsNCiAgICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uoew0KICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAi5re75Yqg5paH56ug5oiQ5YqfIiwNCiAgICAgICAgICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiLA0KICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogMTAwMCwNCiAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goeyBwYXRoOiAiL2VkaXRhcnQiIH0pOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICAgICAgICAgICAgc2hvd0Nsb3NlOiB0cnVlLA0KICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAi5peg5rOV5re75Yqg5paH56ugIiwNCiAgICAgICAgICAgICAgICAgICAgdHlwZTogImVycm9yIiwNCiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IDEwMDAsDQogICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsNCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7DQogICAgICAgICAgICAgIH0pOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgICB0aGlzLiRyZWZzLnVwbG9hZC5zdWJtaXQoKTsNCiAgICB9LA0KICAgIHJlc2V0Rm9ybShmb3JtTmFtZSkgew0KICAgICAgICBpZih0aGlzLmlkKXsNCiAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IHBhdGg6ICIvZWRpdGFydCIgfSk7DQogICAgICAgIH0NCiAgICAgICAgdGhpcy4kcmVmc1tmb3JtTmFtZV0ucmVzZXRGaWVsZHMoKTsNCiAgICB9LA0KICAgIGhhbmRsZVN1Y2Nlc3MocmVzKSB7DQogICAgICB0aGlzLnJ1bGVGb3JtLmltZyA9IHJlczsNCiAgICAgIGlmKHRoaXMucnVsZUZvcm0uaW1nLnVybCl7DQogICAgICAgIHRoaXMudXJsID0gYGh0dHA6Ly9yaWNvbG8uY24vYXBpLyR7dGhpcy5ydWxlRm9ybS5pbWcudXJsfWA7ICANCiAgICAgICAgdGhpcy5pc1Nob3cgPSBmYWxzZTsNCiAgICAgICAgdGhpcy5ydWxlRm9ybS5pbWcgPSB0aGlzLnVybDsNCiAgICAgIH0NCiAgICB9LA0KICAgIGhhbmRsZVJlbW92ZShmaWxlLCBmaWxlTGlzdCkgew0KICAgICAgY29uc29sZS5sb2coZmlsZSwgZmlsZUxpc3QpOw0KICAgIH0sDQogICAgaGFuZGxlUHJldmlldyhmaWxlKSB7DQogICAgICBjb25zb2xlLmxvZyhmaWxlKTsNCiAgICAgIGNvbnNvbGUubG9nKHRoaXMuZmlsZUxpc3QpOw0KICAgIH0NCg0KICB9LA0KfTsNCg=="},{"version":3,"sources":["CreateArt.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"CreateArt.vue","sourceRoot":"src/components/Manage","sourcesContent":["<template>\r\n  <div class=\"addart\">\r\n    <el-form ref=\"ruleForm\" :model=\"ruleForm\" :rules=\"rules\"  label-width=\"100px\" class=\"demo-ruleForm\">\r\n      <el-form-item label=\"标题\" prop=\"title\">\r\n        <el-input v-model=\"ruleForm.title\" placeholder=\"请填写标题\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"作者\" prop=\"author\">\r\n        <el-input v-model=\"ruleForm.author\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"摘要\" prop=\"description\">\r\n        <el-input type=\"textarea\" v-model=\"ruleForm.description\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"分类\" prop=\"classify\">\r\n        <el-select v-model=\"ruleForm.classify\" placeholder=\"请填写分类\">\r\n          <el-option v-for=\"(v,i) in getClassifies\" :key=\"i\" :label=\"v\" :value=\"v\"></el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"封面\" prop=\"img\">\r\n       <el-upload\r\n        class=\"upload-demo\"\r\n        ref=\"upload\"\r\n        action=\"http://ricolo.cn/api/api/blog/editart/img\"\r\n        :on-preview=\"handlePreview\"\r\n        :on-remove=\"handleRemove\"\r\n        :on-success=\"handleSuccess\"\r\n        :auto-upload=\"true\"\r\n        >\r\n        <el-button slot=\"trigger\" size=\"small\" type=\"primary\">选取文件</el-button>\r\n        <div slot=\"tip\" class=\"el-upload__tip\">只能上传jpg/png文件，且不超过500kb</div>\r\n      </el-upload>\r\n        <img :src=\"url\" alt=\"\" id=\"imgs\">\r\n      </el-form-item>\r\n      <el-form-item label=\"内容\" prop=\"content\">\r\n        <mavon-editor v-model=\"ruleForm.content\" />\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" @click=\"onSubmit('ruleForm')\"\r\n          >立即创建</el-button\r\n        >\r\n        <el-button @click=\"resetForm('ruleForm')\">取消</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { addArt, getArt, editArt } from \"../../api/index\";\r\nimport { mapGetters } from 'vuex'\r\nexport default {\r\n  name: \"CreateArt\",\r\n  created() {\r\n    this.id = this.$route.query.id;\r\n    console.log(this.id);\r\n    if (this.id) {\r\n      this.isShow = false;\r\n      getArt(this.id)\r\n        .then((res) => {\r\n          if (res) {\r\n            this.ruleForm = res.data[0];\r\n            console.log(res);\r\n          }\r\n        })\r\n        .catch(function (error) {\r\n          console.log(error);\r\n        });\r\n    }\r\n  },\r\n  computed: {\r\n  // 使用对象展开运算符将 getter 混入 computed 对象中\r\n    ...mapGetters([\r\n\t  'getClassifies',\r\n      // ... \r\n  ])},\r\n  data() {\r\n    return {\r\n      id: \"\",\r\n      content: \"\",\r\n      ruleForm: {\r\n        img:\"\"\r\n      },\r\n      rules: {\r\n        title: [\r\n          { required: true, message: \"请输入标题\", trigger: \"blur\" },\r\n          {\r\n            min: 3,\r\n            max: 255,\r\n            message: \"长度在 3 到 255 个字符\",\r\n            trigger: \"blur\",\r\n          },\r\n        ],\r\n        author: [{ required: true, message: \"请输入姓名\", trigger: \"blur\" }],\r\n        description: [\r\n          { required: true, message: \"请输入摘要\", trigger: \"blur\" },\r\n        ],\r\n        region: [\r\n          { required: true, message: \"请选择活动区域\", trigger: \"change\" },\r\n        ],\r\n        classify: [\r\n          { required: true, message: \"请输入分类\", trigger: \"change\" },\r\n        ],\r\n        content: [{ required: true, message: \"请输入内容\", trigger: \"blur\" }],\r\n      },\r\n      url:'',\r\n      isShow:true\r\n    };\r\n  },\r\n  methods: {\r\n    onSubmit(formName) {\r\n      this.$refs[formName].validate((valid) => {\r\n        if (valid) {\r\n          console.log(this.ruleForm.img)\r\n          if(this.ruleForm.img == \"\"){\r\n            let pic = 1+parseInt(Math.random()*6);\r\n            this.ruleForm.img = `http://ricolo.cn/api/image/${pic}.jpg`\r\n          }\r\n          if (this.$route.query.id) {\r\n            editArt(this.ruleForm)\r\n              .then((res) => {\r\n                if (res.code == \"200\") {\r\n                  this.$message({\r\n                    message: \"修改文章成功\",\r\n                    type: \"success\",\r\n                    duration: 500,\r\n                  });\r\n                } else {\r\n                  this.$message({\r\n                    showClose: true,\r\n                    message: \"无法修改文章\",\r\n                    type: \"error\",\r\n                    duration: 500,\r\n                  });\r\n                }\r\n                this.$router.push({ path: \"/editart\" });\r\n              })\r\n              .catch(function (error) {\r\n                console.log(error);\r\n              });\r\n          } else {\r\n            console.log(this.ruleForm);\r\n            addArt(this.ruleForm)\r\n              .then((res) => {\r\n                console.log(res);\r\n                if (res.code == \"200\") {\r\n                  this.$message({\r\n                    message: \"添加文章成功\",\r\n                    type: \"success\",\r\n                    duration: 1000,\r\n                  });\r\n                  this.$router.push({ path: \"/editart\" });\r\n                } else {\r\n                  this.$message({\r\n                    showClose: true,\r\n                    message: \"无法添加文章\",\r\n                    type: \"error\",\r\n                    duration: 1000,\r\n                  });\r\n                }\r\n              })\r\n              .catch(function (error) {\r\n                console.log(error);\r\n              });\r\n          }\r\n        }\r\n      });\r\n      this.$refs.upload.submit();\r\n    },\r\n    resetForm(formName) {\r\n        if(this.id){\r\n          this.$router.push({ path: \"/editart\" });\r\n        }\r\n        this.$refs[formName].resetFields();\r\n    },\r\n    handleSuccess(res) {\r\n      this.ruleForm.img = res;\r\n      if(this.ruleForm.img.url){\r\n        this.url = `http://ricolo.cn/api/${this.ruleForm.img.url}`;  \r\n        this.isShow = false;\r\n        this.ruleForm.img = this.url;\r\n      }\r\n    },\r\n    handleRemove(file, fileList) {\r\n      console.log(file, fileList);\r\n    },\r\n    handlePreview(file) {\r\n      console.log(file);\r\n      console.log(this.fileList);\r\n    }\r\n\r\n  },\r\n};\r\n</script>\r\n<style scoped lang=\"scss\">\r\n@import \"../../assets/css/base.scss\";\r\n@import \"../../assets/css/mixin.scss\";\r\n.addart {\r\n  padding-right: 20px;\r\n  padding-top: 20px;\r\n  width: 80%;\r\n  margin: 0 auto;\r\n  margin-top: 20px;\r\n  @include font_color();\r\n  @include bg_color();\r\n}\r\n#imgs{\r\n  width: 200px;\r\n  height: 150px;\r\n}\r\n</style>"]}]}